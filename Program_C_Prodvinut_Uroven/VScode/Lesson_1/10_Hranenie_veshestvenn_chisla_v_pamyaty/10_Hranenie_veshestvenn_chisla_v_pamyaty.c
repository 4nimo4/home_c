//--------------------------------------------------------
//   Пример использования union + битовые поля для разбора float
//--------------------------------------------------------
// Здесь показывается, как с помощью объединения (union) и битовых
// полей можно "заглянуть внутрь" числа с плавающей точкой (float)
// и увидеть его знак, порядок (exp) и мантиссу (mant) по стандарту IEEE‑754.
//--------------------------------------------------------

#include <stdio.h>
#include <inttypes.h>

// Объединение для просмотра представления числа float в виде битов
union floatbit 
{
    float value;  // Число с плавающей точкой (32-битный float)

    // Структура с битовыми полями, соответствующая разбиению float:
    // 1 бит  — знак
    // 8 бит  — порядок (exponent)
    // 23 бита — мантисса (fraction)
    //
    // В стандартном формате IEEE-754 для float (32 бита):
    // [ sign (1) | exponent (8) | mantissa (23) ]
    struct 
    {
        uint32_t mant : 23; // 23 бита мантиссы (младшие биты)
        uint32_t exp  : 8;  // 8 бит порядка
        uint32_t sign : 1;  // 1 бит знака (0 — плюс, 1 — минус)
    } bit;
} f; // Глобальная переменная f типа union floatbit (здесь не обязательно, в main есть своя)

int main()
{
    // Локальная переменная f того же типа union floatbit
    union floatbit f;

    // Записываем в поле value число с плавающей точкой.
    // Те же 32 бита можно потом прочитать через f.bit.sign, f.bit.exp, f.bit.mant.
    f.value = -4.1f;
    // Можно попробовать другое значение, например:
    // f.value = 4.0f;

    // sizeof(f) показывает размер всего объединения.
    // Поскольку union занимает размер наибольшего из своих полей,
    // а float и структура из 32-битных полей оба занимают 4 байта,
    // то sizeof(f) обычно равен 4.
    printf("Memory size is %lu\n", sizeof(f));

    // Печатаем исходное значение как обычный float
    printf("f.value = %f\n", f.value);

    // Печатаем отдельные части представления:
    // sign — бит знака (0 или 1)
    printf("sign = %#x\n", f.bit.sign);

    // exp — порядок (exponent), 8-битное значение.
    // В формате IEEE-754 это "смещённый" порядок (biased exponent).
    printf("exp = %#x\n", f.bit.exp);

    // mant — мантисса (fraction), 23 бита.
    printf("mantissa = %#x\n", f.bit.mant);

    return 0;
}
//Важно: Такое использование union и битовых полей для разбора формата 
//IEEE‑754 зависит от реализации: порядок битовых полей и эндianness 
//могут различаться на других платформах/компиляторах.
//Для учебных целей на типичной x86‑платформе это наглядно показывает 
//внутреннее устройство float