//--------------------------------------------------------
//          Указатели
//--------------------------------------------------------
/*
-----------------------------------------------------------
Указателями в Си являются переменные, которые хранят
адрес. Указатель всегда имеет одинаковый размер. Указатель
может хранить адрес:
  ● переменной, в том числе указателя
  ● массива или строки
  ● структуры
  ● функции
----------------------------------------------------
*/

#include <stdio.h>
#include <inttypes.h>

int main(void)
{
    // --- Указатель на обычную переменную ---

    int i = 123;      // обычная целочисленная переменная
    int *pi;          // указатель на int
    pi = &i;          // в pi записываем адрес переменной i

    // --- Указатель на указатель ---

    int **ppi;        // указатель на указатель на int
    ppi = &pi;        // ppi хранит адрес переменной pi

    // Разыменование:
    //  *ppi  → это pi  (указатель на int)
    //  **ppi → это i   (само целое значение)
    printf("**ppi = %d\n", **ppi);  // выведет 123


    // --- Указатель на структуру ---

    struct s 
    {
        int   i;
        float f;
    } st = {1, 0.0f}; // объект структуры s

    struct s *ps = &st; // указатель на структуру

    // Доступ к полям структуры через указатель:
    //   (*ps).i  и  ps->i  — одно и то же.
    printf("ps->i = %d\n", ps->i);


    // --- Указатель на первый элемент массива (одномерный массив) ---

    int ar[5] = {1, 2, 3, 4, 5};
    int *pa;          // указатель на int (элемент массива)

    // Имя массива ar в выражениях неявно преобразуется к указателю
    // на его первый элемент: &ar[0].
    // Поэтому pa = ar; и pa = &ar[0]; эквивалентны.
    pa = ar;

    // Разыменование с индексами:
    //   *pa       → ar[0] = 1
    //   *(pa + 1) → ar[1] = 2
    //   *(pa + 2) → ar[2] = 3
    //   ...
    printf("*pa      = %d\n", *pa);         // 1‑й элемент (ar[0])
    printf("*(pa+1)  = %d\n", *(pa + 1));   // 2‑й элемент (ar[1])
    printf("*(pa+2)  = %d\n", *(pa + 2));   // 3‑й элемент (ar[2])
    printf("*(pa+3)  = %d\n", *(pa + 3));   // 4‑й элемент (ar[3])
    printf("*(pa+4)  = %d\n", *(pa + 4));   // 5‑й элемент (ar[4])


    // --- Указатель на строку двумерного массива ---

    // Двумерный массив 3x5:
    //   строка 0:  1  2  3  4  5
    //   строка 1: 11 12 13 14 15
    //   строка 2: 21 22 23 24 25
    int ar2[3][5] = {
        {  1,  2,  3,  4,  5 },
        { 11, 12, 13, 14, 15 },
        { 21, 22, 23, 24, 25 }
    };

    // pa2 — указатель на массив из 5 int:
    //   тип: int (*)[5]
    //
    // То есть pa2 хранит адрес "строки" (подмассива из 5 элементов).
    int (*pa2)[5];

    // Адрес 0‑й строки (ar2[0]):
    //   pa2 = ar2;  эквивалентно  pa2 = &ar2[0];
    pa2 = ar2;
    // *pa2      → указатель на первый элемент 0‑й строки (&ar2[0][0])
    // **pa2     → значение этого элемента: ar2[0][0] = 1
    // *(*pa2+1) → ar2[0][1] = 2
    printf("Row 0, col 0 = %d\n", **pa2);         // 1
    printf("Row 0, col 1 = %d\n", *(*pa2 + 1));   // 2

    // Адрес 1‑й строки (ar2[1]):
    pa2 = ar2 + 1;  // &ar2[1]
    printf("Row 1, col 0 = %d\n", **pa2);         // 11
    printf("Row 1, col 1 = %d\n", *(*pa2 + 1));   // 12

    // Адрес 2‑й строки (ar2[2]):
    pa2 = ar2 + 2;  // &ar2[2]
    printf("Row 2, col 0 = %d\n", **pa2);         // 21
    printf("Row 2, col 1 = %d\n", *(*pa2 + 1));   // 22

    return 0;
}