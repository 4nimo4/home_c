/*
//--------------------------------------------------------------------
                Процесс сборки
                Побитовые операции
//------------------------------------------------------------------------
Стандарт IEEE 754
//------------------------------------------------------------------------
            для float (32 бит)
    | 31       | с 30 по 21     | с 22 по 0        |
    |знак 1 бит| порядок  8 бит | мантисса 23 бита |

            для double (64 бит)
    | 63       | с 62 по 50     | с 51 по 0        |
    |знак 1 бит| порядок 11 бит | мантисса 52 бита |
//------------------------------------------------------------------------
        Задача
//------------------------------------------------------------------------
Прочитать из потока ввода число типа float и затем
вывести его на экран в формате a*2\^b,(a - это у нас мантисса * 2 в степени b), 
где a и b — десятичные числа, причём а в диапазоне от [0,1; 1).
//------------------------------------------------------------------------
Пример решения: float.c
//------------------------------------------------------------------------
Пояснения:
//------------------------------------------------------------------------
Программа разбирает число float на мантиссу и порядок по стандарту IEEE 754.
Мантисса всегда начинается с 1, а дробная часть вычисляется из битов числа.
Порядок (экспонента) извлекается из соответствующих битов и корректируется на смещение 127.
Вывод идёт в виде
1,xxxxxxxxx*2^b
, где x — цифры мантиссы, b — порядок.
//------------------------------------------------------------------------
*/
/*
#include <stdio.h>
#include <stdint.h>

int main ()
{
    float a=0;
    uint32_t * pa = (uint32_t *)&a;
    int o=0;
    printf("Введите число\n");
    scanf ("%f", &a);
    printf("Введенное число в формате a*2\\^b выглядит так:\n");
    if(a<0)
    {
        putchar('-');   //проверяем знак
    }

    float m_f = (*pa & 0x7FFFFF ) / (float)0x800000 ;//вычленяем мантиссу с помощью побитовых операций
                                                //получаем младьшие 23 бита
    o = (((*pa) >> 23) & 0xFF) - 127 ;  //выделяем порядок через побитовые операции

    putchar('1');
    putchar(',');

    for (int i = 0; i < 9; i++)
    {
        m_f *=10;   //пишем 1,
        putchar ('0'+ m_f); //пишем мантиссу
        m_f = m_f - (int)m_f;
    }

    putchar('*');   //пишем 2 в степени
    putchar('2');
    putchar('^');

    if(o<0)             //далее пишем наш порядок
    {
        putchar('-');
        o=-o;
    }
    if ( o >= 100)
    {
        putchar('1');
        o%=100;
    }
    if(o>=10)
    {
        putchar('0' + o/10);
        o%=10;
    }
    putchar('0' + o);
    printf("\n");
    return 0;
}
*/
#include <stdio.h>      // Для функций ввода-вывода
#include <stdint.h>     // Для uint32_t

int main ()
{
    float a = 0;                        // Переменная для ввода числа
    uint32_t *pa = (uint32_t *)&a;      // Указатель на те же 4 байта, что и float, но как на uint32_t
    int o = 0;                          // Переменная для хранения порядка (экспоненты)

    printf("Введите число\n");
    scanf("%f", &a);                    // Вводим число с плавающей точкой

    printf("Введенное число в формате a*2\\^b выглядит так:\n");

    if(a < 0)                           // Если число отрицательное — выводим минус
    {
        putchar('-');
    }

    // Выделяем мантиссу: 23 младших бита, делим на 2^23, чтобы получить дробную часть
    float m_f = (*pa & 0x7FFFFF) / (float)0x800000;

    // Выделяем порядок: сдвигаем на 23 бита вправо, берём 8 бит, вычитаем смещение 127
    o = (((*pa) >> 23) & 0xFF) - 127;

    putchar('1');       // В формате IEEE 754 мантисса всегда начинается с 1,
    putchar(',');       // поэтому выводим "1,"

    // Выводим 9 знаков после запятой для мантиссы
    for (int i = 0; i < 9; i++)
    {
        m_f *= 10;                      // Умножаем на 10, чтобы получить следующую цифру
        putchar('0' + (int)m_f);        // Выводим целую часть как цифру
        m_f = m_f - (int)m_f;           // Оставляем только дробную часть
    }

    putchar('*');       // Выводим символ умножения
    putchar('2');       // Основание степени
    putchar('^');       // Символ степени

    if(o < 0)           // Если порядок отрицательный — выводим минус
    {
        putchar('-');
        o = -o;
    }

    // Выводим порядок (экспоненту) поразрядно
    if (o >= 100)
    {
        putchar('1');
        o %= 100;
    }
    if(o >= 10)
    {
        putchar('0' + o / 10);
        o %= 10;
    }
    putchar('0' + o);

    printf("\n");       // Перевод строки
    return 0;
}